#+SETUPFILE:./hugo_setup.org
#+HUGO_SECTION: zettels
#+HUGO_SLUG: first_time_roam
#+TITLE: literate coding

Go back to inbox: [[file:2020-03-02.org][Other Brain Inbox]]

* My Dotfiles

** on my bash
[[file:~/.oh-my-bash/][on-my-bash dir]]
** fzf
[[file:~/.fzf/][fzf folder]]
** nvm
[[file:~/.nvm/][nvm folder]]

You must set mirror of nodejs to avoid building from source
#+BEGIN_SRC shell
cd && touch .profile
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.1/install.sh | bash
echo "export NVM_NODEJS_ORG_MIRROR=https://unofficial-builds.nodejs.org/download/release" >> .profile
echo "nvm_get_arch() { nvm_echo \"x86\"; }" >> .profile
source .profile
#+END_SRC
** pyenv

+ Visit =pyenv installer= project:
https://github.com/pyenv/pyenv-installer

+ The file installed:
[[file:~/.pyenv/][pyenv dir]]

+ The =readme=
[[file:~/.pyenv/README.md][pyenv Readme]]

[[file:~/.pyenv/COMMANDS.md][pyenv command manual]]

#+BEGIN_SRC shell
sudo apt-get install -y libbz2-dev libsqlite3-dev libssh-dev libreadline-dev
sudo apt-get install -y python3-venv
#+END_SRC

#+RESULTS:
| Reading         | package                       | lists...          |                                             |                 |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Building        | dependency                    | tree...           |                                             |                 |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Reading         | state                         | information...    |                                             |                 |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| libbz2-dev      | is                            | already           | the                                         | newest          | version | (1.0.6-9.2~deb10u1). |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| libssh-dev      | is                            | already           | the                                         | newest          | version | (0.8.7-1).           |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| libreadline-dev | is                            | already           | the                                         | newest          | version | (7.0-5).             |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| libsqlite3-dev  | is                            | already           | the                                         | newest          | version | (3.27.2-3).          |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| 0               | upgraded,                     | 0                 | newly                                       | installed,      | 0       | to                   | remove   | and   |            58 | not      | upgraded. |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Reading         | package                       | lists...          |                                             |                 |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Building        | dependency                    | tree...           |                                             |                 |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Reading         | state                         | information...    |                                             |                 |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| The             | following                     | additional        | packages                                    | will            | be      | installed:           |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| python3.7-venv  |                               |                   |                                             |                 |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| The             | following                     | NEW               | packages                                    | will            | be      | installed:           |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| python3-venv    | python3.7-venv                |                   |                                             |                 |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| 0               | upgraded,                     | 2                 | newly                                       | installed,      | 0       | to                   | remove   | and   |            58 | not      | upgraded. |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Need            | to                            | get               | 7                                           | B               | of      | archives.            |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| After           | this                          | operation,        | 44.0                                        | kB              | of      | additional           | disk     | space |          will | be       | used.     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Get:1           | https://deb.debian.org/debian | buster/main       | i386                                        | python3.7-venv  | i386    | 3.7.3-2+deb10u1      | [6,144   | B]    |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Get:2           | https://deb.debian.org/debian | buster/main       | i386                                        | python3-venv    | i386    | 3.7.3-1              | [1,180   | B]    |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Fetched         | 7                             | B                 | in                                          | 1s              | (8,874  | B/s)                 |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Selecting       | previously                    | unselected        | package                                     | python3.7-venv. |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| (Reading        | database                      | ...               | (Reading                                    | database        | ...     | 5%
(Reading         | database | ...   | 10%
(Reading | database | ...       | 15%
(Reading | database | ... | 20%
(Reading | database | ... | 25%
(Reading | database | ... | 30%
(Reading | database | ... | 35%
(Reading | database | ... | 40%
(Reading | database | ... | 45%
(Reading | database | ... | 50%
(Reading | database | ... | 55%
(Reading | database | ... | 60%
(Reading | database | ... | 65%
(Reading | database | ... | 70%
(Reading | database | ... | 75%
(Reading | database | ... | 80%
(Reading | database | ... | 85%
(Reading | database | ... | 90%
(Reading | database | ... | 95%
(Reading | database | ... | 100%
(Reading | database | ... | 71241 | files | and | directories | currently | installed.) |
| Preparing       | to                            | unpack            | .../python3.7-venv_3.7.3-2+deb10u1_i386.deb | ...             |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Unpacking       | python3.7-venv                | (3.7.3-2+deb10u1) | ...                                         |                 |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Selecting       | previously                    | unselected        | package                                     | python3-venv.   |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Preparing       | to                            | unpack            | .../python3-venv_3.7.3-1_i386.deb           | ...             |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Unpacking       | python3-venv                  | (3.7.3-1)         | ...                                         |                 |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Setting         | up                            | python3.7-venv    | (3.7.3-2+deb10u1)                           | ...             |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Setting         | up                            | python3-venv      | (3.7.3-1)                                   | ...             |         |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |
| Processing      | triggers                      | for               | man-db                                      | (2.8.5-2)       | ...     |                      |          |       |               |          |           |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |               |          |     |                |          |     |       |       |     |             |           |             |


#+BEGIN_SRC shell
export PATH=~/.pyenv/bin:$PATH
pyenv global
# pyenv install 3.8.2
pyenv global 3.8.2
#+END_SRC

#+RESULTS:
: system

** pipenv

[[file:~/.local/lib/python3.7/site-packages/pipenv/][pipenv install location]]

The =executable= location
[[file:~/.local/bin/pipenv][pipenv bin file]]

#+BEGIN_SRC shell
ls /home/vagrant/workspace/python_env/flask/
ls /home/vagrant/workspace/python_env/flask/Pipfile
cat /home/vagrant/workspace/python_env/flask/Pipfile
cd /home/vagrant/workspace/python_env/flask
pipenv install
#+END_SRC

#+RESULTS:
| app.py                                           |   |                         |
| Pipfile                                          |   |                         |
| Pipfile.lock                                     |   |                         |
| /home/vagrant/workspace/python_env/flask/Pipfile |   |                         |
| [[source]]                                           |   |                         |
| name                                             | = | pypi                    |
| url                                              | = | https://pypi.org/simple |
| verify_ssl                                       | = | true                    |
| [dev-packages]                                   |   |                         |
| [packages]                                       |   |                         |
| [requires]                                       |   |                         |
| python_version                                   | = | 3.8                     |


*** Using ~pipenv~ in emacs with ~pipenv-mode~

#+BEGIN_SRC shell

pip3 install --user --no-warn-script-location pipenv

#+END_SRC

In your shell, you can run the following command to run your spider
#+BEGIN_SRC shell

ls /home/vagrant/Dropbox/shared/information-center
cd /home/vagrant/Dropbox/shared/information-center
pipenv --python 3.8.2
pipenv install scrapy --dev
pipenv shell
scrapy crawl your-spider-name

#+END_SRC

#+RESULTS:
| InformationCenter |
| Pipfile           |
| scrapy.cfg        |

But how to use it in emacs?
Configuration:[[file:~/.emacs.d/modules/lang/python/config.el][doom python module config file]]

#+BEGIN_SRC emacs-lisp

(use-package! pipenv
  :commands pipenv-project-p
  :hook (python-mode . pipenv-mode)
  :init (setq pipenv-with-projectile nil)
  :config
  (set-eval-handler! 'python-mode
    '((:command . (lambda () python-shell-interpreter))
      (:exec (lambda ()
               (if-let* ((bin (executable-find "pipenv"))
                         (_ (pipenv-project-p)))
                   (format "PIPENV_MAX_DEPTH=9999 %s run %%c %%o %%s %%a" bin)
                 "%c %o %s %a")))
      (:description . "Run Python script")))
  (map! :map python-mode-map
        :localleader
        :prefix "e"
        :desc "activate"    "a" #'pipenv-activate
        :desc "deactivate"  "d" #'pipenv-deactivate
        :desc "install"     "i" #'pipenv-install
        :desc "lock"        "l" #'pipenv-lock
        :desc "open module" "o" #'pipenv-open
        :desc "run"         "r" #'pipenv-run
        :desc "shell"       "s" #'pipenv-shell
        :desc "uninstall"   "u" #'pipenv-uninstall))
#+END_SRC

Basicly, we just adde keymaps with =localleader= and =prefix=, all the command
are just the pair command of pipenv

#+BEGIN_SRC shell
pipenv
#+END_SRC

#+RESULTS:
| Usage:                | pipenv      | [OPTIONS]           | COMMAND      | [ARGS]...       |              |                  |                      |             |          |     |    |
| Options:              |             |                     |              |                 |              |                  |                      |             |          |     |    |
| --where               | Output      | project             | home         | information.    |              |                  |                      |             |          |     |    |
| --venv                | Output      | virtualenv          | information. |                 |              |                  |                      |             |          |     |    |
| --py                  | Output      | Python              | interpreter  | information.    |              |                  |                      |             |          |     |    |
| --envs                | Output      | Environment         | Variable     | options.        |              |                  |                      |             |          |     |    |
| --rm                  | Remove      | the                 | virtualenv.  |                 |              |                  |                      |             |          |     |    |
| --bare                | Minimal     | output.             |              |                 |              |                  |                      |             |          |     |    |
| --completion          | Output      | completion          | (to          | be              | eval'd).     |                  |                      |             |          |     |    |
| --man                 | Display     | manpage.            |              |                 |              |                  |                      |             |          |     |    |
| --support             | Output      | diagnostic          | information  | for             | use          | in               | GitHub               | issues.     |          |     |    |
| --site-packages       | Enable      | site-packages       | for          | the             | virtualenv.  | [env             | var:                 |             |          |     |    |
| PIPENV_SITE_PACKAGES] |             |                     |              |                 |              |                  |                      |             |          |     |    |
| --python              | TEXT        | Specify             | which        | version         | of           | Python           | virtualenv           | should      | use.     |     |    |
| --three               | /           | --two               | Use          | Python          | 3/2          | when             | creating             | virtualenv. |          |     |    |
| --clear               | Clears      | caches              | (pipenv,     | pip,            | and          | pip-tools).      | [env                 | var:        |          |     |    |
| PIPENV_CLEAR]         |             |                     |              |                 |              |                  |                      |             |          |     |    |
| -v,                   | --verbose   | Verbose             | mode.        |                 |              |                  |                      |             |          |     |    |
| --pypi-mirror         | TEXT        | Specify             | a            | PyPI            | mirror.      |                  |                      |             |          |     |    |
| --version             | Show        | the                 | version      | and             | exit.        |                  |                      |             |          |     |    |
| -h,                   | --help      | Show                | this         | message         | and          | exit.            |                      |             |          |     |    |
| Usage                 | Examples:   |                     |              |                 |              |                  |                      |             |          |     |    |
| Create                | a           | new                 | project      | using           | Python       | 3.7              | specifically:        |             |          |     |    |
| $                     | pipenv      | --python            | 3.7          |                 |              |                  |                      |             |          |     |    |
| Remove                | project     | virtualenv          | (inferred    | from            | current      | directory):      |                      |             |          |     |    |
| $                     | pipenv      | --rm                |              |                 |              |                  |                      |             |          |     |    |
| Install               | all         | dependencies        | for          | a               | project      | (including       | dev):                |             |          |     |    |
| $                     | pipenv      | install             | --dev        |                 |              |                  |                      |             |          |     |    |
| Create                | a           | lockfile            | containing   | pre-releases:   |              |                  |                      |             |          |     |    |
| $                     | pipenv      | lock                | --pre        |                 |              |                  |                      |             |          |     |    |
| Show                  | a           | graph               | of           | your            | installed    | dependencies:    |                      |             |          |     |    |
| $                     | pipenv      | graph               |              |                 |              |                  |                      |             |          |     |    |
| Check                 | your        | installed           | dependencies | for             | security     | vulnerabilities: |                      |             |          |     |    |
| $                     | pipenv      | check               |              |                 |              |                  |                      |             |          |     |    |
| Install               | a           | local               | setup.py     | into            | your         | virtual          | environment/Pipfile: |             |          |     |    |
| $                     | pipenv      | install             | -e           | .               |              |                  |                      |             |          |     |    |
| Use                   | a           | lower-level         | pip          | command:        |              |                  |                      |             |          |     |    |
| $                     | pipenv      | run                 | pip          | freeze          |              |                  |                      |             |          |     |    |
| Commands:             |             |                     |              |                 |              |                  |                      |             |          |     |    |
| check                 | Checks      | for                 | security     | vulnerabilities | and          | against          | PEP                  | 508         | markers  |     |    |
| provided              | in          | Pipfile.            |              |                 |              |                  |                      |             |          |     |    |
| clean                 | Uninstalls  | all                 | packages     | not             | specified    | in               | Pipfile.lock.        |             |          |     |    |
| graph                 | Displays    | currently-installed | dependency   | graph           | information. |                  |                      |             |          |     |    |
| install               | Installs    | provided            | packages     | and             | adds         | them             | to                   | Pipfile,    | or       | (if | no |
| packages              | are         | given),             | installs     | all             | packages     | from             | Pipfile.             |             |          |     |    |
| lock                  | Generates   | Pipfile.lock.       |              |                 |              |                  |                      |             |          |     |    |
| open                  | View        | a                   | given        | module          | in           | your             | editor.              |             |          |     |    |
| run                   | Spawns      | a                   | command      | installed       | into         | the              | virtualenv.          |             |          |     |    |
| shell                 | Spawns      | a                   | shell        | within          | the          | virtualenv.      |                      |             |          |     |    |
| sync                  | Installs    | all                 | packages     | specified       | in           | Pipfile.lock.    |                      |             |          |     |    |
| uninstall             | Un-installs | a                   | provided     | package         | and          | removes          | it                   | from        | Pipfile. |     |    |
| update                | Runs        | lock,               | then         | sync.           |              |                  |                      |             |          |     |    |

